!function(){class t extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(t.content.cloneNode(!0))}$(t){return this.shadowRoot.querySelector(t)}$$(t){return this.shadowRoot.querySelectorAll(t)}}class e extends t{static get is(){return"acsv-file-select"}constructor(){super(document.body.querySelector(`#${e.is}-template`))}connectedCallback(){const t=this.$("input");t.addEventListener("change",this.onChange_.bind(this));this.$("slot").assignedElements()[0].addEventListener("click",()=>t.click())}onChange_(){const t=Array.from(this.$("input").files);0!==t.length&&this.dispatchEvent(new CustomEvent("files-selected",{composed:!0,detail:t}))}}customElements.define(e.is,e);class n extends t{static get is(){return"acsv-demo-app"}constructor(){super(document.body.querySelector(`#${n.is}-template`))}connectedCallback(){this.$("acsv-file-select").addEventListener("files-selected",this.onFilesSelected_.bind(this)),this.$("#convert").addEventListener("click",this.onConvertClick_.bind(this)),this.$("#export").addEventListener("click",this.onExportClick_.bind(this)),this.$("#copy").addEventListener("click",this.onCopyClick_.bind(this))}onFilesSelected_(t){const e=t.detail[0];var n;(n=e,new Promise((function(t,e){const s=new FileReader;s.onloadend=function(){t(s.result)},s.onerror=e,s.readAsText(n)}))).then(t=>{const n=this.$("#input"),s=e.size/Math.pow(10,6);n.value=s<2?t:"File is larger than 2mb, hiding contents for better performance",this.convert_(t)})}toggleDisabled_(t){for(const e of this.$$("button"))e.toggleAttribute("disabled",t)}onConvertClick_(){this.convert_(this.$("#input").value)}convert_(t){const e=this.$("#output");e.value="Converting...",this.toggleDisabled_(!0),setTimeout(()=>{const n=function(t){const e=[],n=function(t){const e=[];let n=-1,s=!1,o=0,i=[];function c(){const e='"'===t[o-1]?1:0;i.push(t.substring(n+1+e,o-e)),n=o}for(;o<t.length;){const l=t[o];s?'"'===l?'"'===t[o+1]?o+=2:(s=!1,o<t.length-1?o++:(o++,c(),e.push(i))):o++:(","===l?c():'"'===l?s=!0:"\r"===l?(c(),e.push(i),i=[],o++,n=o):"\n"===l?(c(),e.push(i),i=[]):o===t.length-1&&(o++,c(),e.push(i)),o++)}return e}(t);if(0===n.length)return e;const s=n[0];for(let t=1;t<n.length;t++){const o={};for(let e=0;e<s.length;e++)o[s[e]]=n[t][e];e.push(o)}return e}(t);e.value=JSON.stringify(n,null,2),this.toggleDisabled_(!1)},0)}onExportClick_(){!function(t){const e=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(e),s=document.createElement("a");s.href=n,s.download="achilles.json",s.click()}(this.$("#output").value)}onCopyClick_(){this.$("#output").select(),document.execCommand("copy")}}customElements.define(n.is,n)}();